{
    "l_app_api.py": "from fastapi import APIRouter\n\nfrom app.api.responses import Responses, response_docs\nfrom app.services.tpl import (\n    TplSvc,\n    TplList,\n)\n\nrouter = APIRouter()\n\ntpl_svc = TplSvc()\n\n\n@router.get(\n    path=\"/tpls\",\n    summary=\"list\",\n    responses=response_docs(data={\n        \"items\": [{\n            \"id\": \"str\",\n        }],\n        \"total\": \"int\",\n    }),\n)\nasync def list_tpl(\n    page: int = 1,\n    size: int = 10,\n    # current_user: JWTUser = Depends(get_current_user),  # TODO: \u8ba4\u8bc1\n):\n    req = TplList(\n        page=page,\n        size=size,\n    )\n    data = await tpl_svc.list_tpl(req)\n    return Responses.success(data=data)\n",
    "l_app_services.py": "from pydantic import BaseModel, Field\n\n\nclass TplList(BaseModel):\n    page: int = Field(1, ge=1)\n    size: int = Field(10, ge=1, le=200)\n\n\nclass TplSvc:\n\n    @staticmethod\n    async def list_tpl(req):\n        # TODO: \u4e1a\u52a1\u903b\u8f91\n        items, total = [], 0\n        return {\"items\": items, \"total\": total}\n",
    "s_app_api.py": "from fastapi import APIRouter, Depends\n\nfrom app.api.dependencies import JWTUser, get_current_user\nfrom app.api.responses import Responses, response_docs\nfrom app.models.tpl import (\n    TplList,\n    TplCreate,\n    TplUpdate,\n)\nfrom app.services.tpl import TplSvc\n\nrouter = APIRouter()\n\n# -------------------- \u8bf7\u6839\u636e\u81ea\u8eab\u9700\u6c42\u4fee\u6539 --------------------\n\ntpl_svc = TplSvc()\n\n\n@router.get(\n    path=\"/tpls\",\n    summary=\"list\",\n    responses=response_docs(data={\n        \"items\": [{\n            \"id\": \"str\",\n            \"name\": \"str\",\n            \"created_at\": \"int\",\n            \"updated_at\": \"int\",\n        }],\n        \"total\": \"int\",\n    }),\n)\nasync def list_tpl(\n    page: int = 1,\n    size: int = 10,\n    current_user: JWTUser = Depends(get_current_user),\n):\n    req = TplList(\n        page=page,\n        size=size,\n    )\n    data = await tpl_svc.list_tpl(req)\n    return Responses.success(data=data)\n\n\n@router.post(\n    path=\"/tpls\",\n    summary=\"create\",\n    responses=response_docs(data={\n        \"id\": \"str\",\n    }),\n)\nasync def create_tpl(\n    req: TplCreate,\n    current_user: JWTUser = Depends(get_current_user),\n):\n    created_id = await tpl_svc.create_tpl(req)\n    return Responses.success(data={\"id\": created_id})\n\n\n@router.get(\n    path=\"/tpls/{tpl_id}\",\n    summary=\"get\",\n    responses=response_docs(data={\n        \"id\": \"str\",\n        \"name\": \"str\",\n        \"created_at\": \"int\",\n        \"updated_at\": \"int\",\n    }),\n)\nasync def get_tpl(\n    tpl_id: str,\n    current_user: JWTUser = Depends(get_current_user),  # \u8ba4\u8bc1\n):\n    data = await tpl_svc.get_tpl(tpl_id)\n    return Responses.success(data=data)\n\n\n@router.delete(\n    path=\"/tpls/{tpl_id}\",\n    summary=\"delete\",\n    responses=response_docs(data={\n        \"id\": \"str\",\n    }),\n)\nasync def delete_tpl(\n    tpl_id: str,\n    current_user: JWTUser = Depends(get_current_user),\n):\n    deleted_id = await tpl_svc.delete_tpl(tpl_id)\n    return Responses.success(data={\"id\": deleted_id})\n\n\n@router.put(\n    path=\"/tpls/{tpl_id}\",\n    summary=\"update\",\n    responses=response_docs(data={\n        \"id\": \"str\",\n    }),\n)\nasync def update_tpl(\n    tpl_id: str,\n    req: TplUpdate,\n    current_user: JWTUser = Depends(get_current_user),\n):\n    updated_id = await tpl_svc.update_tpl(req, tpl_id=tpl_id)\n    return Responses.success(data={\"id\": updated_id})\n",
    "s_app_api_nodeclorm.py": "from fastapi import APIRouter\n\nfrom app.api.responses import Responses, response_docs\nfrom app.models.tpl import (\n    TplList,\n)\nfrom app.services.tpl import TplSvc\n\nrouter = APIRouter()\n\ntpl_svc = TplSvc()\n\n\n@router.get(\n    path=\"/tpls\",\n    summary=\"list\",\n    responses=response_docs(data={\n        \"items\": [{\n            \"id\": \"str\",\n            \"name\": \"str\",\n            \"created_at\": \"int\",\n            \"updated_at\": \"int\",\n        }],\n        \"total\": \"int\",\n    }),\n)\nasync def list_tpl(\n    page: int = 1,\n    size: int = 10,\n    # current_user: JWTUser = Depends(get_current_user),  # TODO: \u8ba4\u8bc1\n):\n    req = TplList(\n        page=page,\n        size=size,\n    )\n    data = await tpl_svc.list_tpl(req)\n    return Responses.success(data=data)\n",
    "s_app_models.py": "from pydantic import Field, BaseModel\nfrom sqlalchemy import BigInteger, String\nfrom sqlalchemy.orm import mapped_column\n\nfrom app.models import DeclBase\nfrom app.utils.ext_util import gen_snow_id, now_timestamp\n\n\nclass Tpl(DeclBase):\n    __tablename__ = \"tpls\"\n\n    id = mapped_column(BigInteger, primary_key=True, default=gen_snow_id, nullable=False, comment=\"\u4e3b\u952e\")\n    name = mapped_column(String(50), unique=True, index=True, nullable=False, comment=\"\u540d\u79f0\")\n    # #\n    created_at = mapped_column(BigInteger, default=now_timestamp, nullable=False, comment=\"\u521b\u5efa\u65f6\u95f4\")\n    updated_at = mapped_column(BigInteger, default=now_timestamp, onupdate=now_timestamp, nullable=False, comment=\"\u66f4\u65b0\u65f6\u95f4\")\n\n\nclass TplList(BaseModel):\n    page: int = Field(1, ge=1)\n    size: int = Field(10, ge=1, le=200)\n\n\nclass TplCreate(BaseModel):\n    name: str = Field(min_length=1, max_length=50)\n\n\nclass TplUpdate(BaseModel):\n    name: str | None = Field(None, min_length=1, max_length=50)\n",
    "s_app_models_nodeclorm.py": "from pydantic import BaseModel, Field\n\n\nclass Tpl:\n    __tablename__ = \"tpls\"\n\n\nclass TplList(BaseModel):\n    page: int = Field(1, ge=1)\n    size: int = Field(10, ge=1, le=200)\n",
    "s_app_services.py": "from sqlalchemy.exc import IntegrityError\n\nfrom app.api.exceptions import CustomException\nfrom app.api.status import Status\nfrom app.initializer import g\nfrom app.models.tpl import Tpl\n\n\nclass TplSvc:\n\n    @staticmethod\n    async def list_tpl(req):\n        async with g.db_async_session() as session:\n            items = await Tpl.fetch_all(\n                session=session,\n                columns=(\n                    \"id\",\n                    \"name\",\n                    \"created_at\",\n                    \"updated_at\",\n                ),\n                order_by=\"-created_at\",\n                offset=(req.page - 1) * req.size,\n                limit=req.size,\n                converters={\"id\": str},\n            )\n            total = await Tpl.count(session=session)\n            return {\"items\": items, \"total\": total}\n\n    @staticmethod\n    async def create_tpl(req):\n        async with g.db_async_session() as session:\n            result = await Tpl.create(\n                session=session,\n                values={\n                    \"name\": req.name,\n                },\n                on_conflict={\"name\": req.name},\n                flush=True,\n            )\n            if not result:\n                raise CustomException(status=Status.RECORD_EXISTS_ERROR)\n            await session.commit()\n            return str(result.data[\"id\"])\n\n    @staticmethod\n    async def get_tpl(tpl_id):\n        async with g.db_async_session() as session:\n            data = await Tpl.fetch_one(\n                session=session,\n                where={\"id\": int(tpl_id)},\n                columns=(\n                    \"id\",\n                    \"name\",\n                    \"created_at\",\n                    \"updated_at\",\n                ),\n                converters={\"id\": str},\n            )\n            if not data:\n                raise CustomException(status=Status.RECORD_NOT_EXIST_ERROR)\n            return data\n\n    @staticmethod\n    async def delete_tpl(tpl_id):\n        async with g.db_async_session() as session:\n            result = await Tpl.delete(\n                session=session,\n                where={\"id\": int(tpl_id)},\n            )\n            if not result:\n                raise CustomException(status=Status.RECORD_NOT_EXIST_ERROR)\n            await session.commit()\n            return tpl_id\n\n    @staticmethod\n    async def update_tpl(req, tpl_id: str):\n        async with g.db_async_session() as session:\n            try:\n                result = await Tpl.update(\n                    session=session,\n                    where={\"id\": int(tpl_id)},\n                    values=req.model_dump(),\n                )\n                if not result:\n                    raise CustomException(status=Status.RECORD_NOT_EXIST_ERROR)\n                await session.commit()\n            except IntegrityError:\n                raise CustomException(status=Status.RECORD_EXISTS_ERROR)\n            return tpl_id\n",
    "s_app_services_nodeclorm.py": "\n\nclass TplSvc:\n\n    @staticmethod\n    async def list_tpl(req):\n        # TODO: \u4e1a\u52a1\u903b\u8f91\n        data, total = [], 0\n        return {\"items\": data, \"total\": total}\n",
    "t_app_api.py": "from fastapi import APIRouter\n\nfrom app.api.responses import Responses, response_docs\n\nrouter = APIRouter()\n\n\n@router.get(\n    path=\"/tpls\",\n    summary=\"list\",\n    responses=response_docs(data={\n        \"items\": [{\n            \"id\": \"str\",\n        }],\n        \"total\": \"int\",\n    }),\n)\nasync def list_tpl(\n    page: int = 1,\n    size: int = 10,\n    # current_user: JWTUser = Depends(get_current_user),  # TODO: \u8ba4\u8bc1\n):\n    # TODO: \u4e1a\u52a1\u903b\u8f91\n    data = {\n        \"items\": [],\n        \"total\": 0,\n    }\n    return Responses.success(data=data)\n"
}